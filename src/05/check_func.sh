#!/usr/bin/env bash
set -euo pipefail

# Проверка параметра режима: ровно 1, и он 1|2|3|4
check_mode() {
  if [[ $# -ne 1 ]]; then
    echo "Ошибка: скрипт принимает ровно один параметр (1, 2, 3 или 4)." >&2
    echo "Пример: ./main.sh 3" >&2
    exit 1
  fi
  local mode="$1"
  if ! [[ "$mode" =~ ^[1-4]$ ]]; then
    echo "Ошибка: параметр должен быть одним из: 1, 2, 3, 4." >&2
    exit 1
  fi
}

# Спросить путь к папке с логами и убедиться, что есть *.log
ask_logs_dir() {
    local dir
    read -r -p "Введите путь к папке с .log файлами: " dir

  # пустой ввод
    if [[ -z "${dir}" ]]; then
        echo "Ошибка: путь не указан." >&2
        exit 1
    fi

  # нормализуем от лишнего завершающего слэша
    dir="${dir%/}"

    if [[ ! -d "$dir" ]]; then
        echo "Ошибка: директория '$dir' не существует." >&2
        exit 1
    fi

  # Есть ли .log?
  # Используем ls с редиректом, чтобы без лишнего шума
    if ! ls "$dir"/*.log >/dev/null 2>&1; then
        echo "Ошибка: в '$dir' не найдено файлов с расширением .log" >&2
        exit 1
    fi

  # вернуть значение через echo (простой способ в bash)
    echo "$dir"
}